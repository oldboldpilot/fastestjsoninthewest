# LLVM/Clang 21 Full Rebuild Session State
**Date:** November 16, 2025  
**Status:** IN PROGRESS - Background Build Running

## Build Configuration

### Build Directory
```
/home/muyiwa/toolchain-build/llvm-full-build
```

### Installation Target
```
/opt/clang-21
```

### CMake Configuration
```bash
cmake -G Ninja \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_C_COMPILER=/usr/bin/gcc \
  -DCMAKE_CXX_COMPILER=/usr/bin/g++ \
  -DCMAKE_MAKE_PROGRAM=/usr/local/bin/ninja \
  -DCMAKE_INSTALL_PREFIX=/opt/clang-21 \
  -DLLVM_ENABLE_PROJECTS="clang;clang-tools-extra;lld;mlir;openmp" \
  -DLLVM_ENABLE_RUNTIMES="compiler-rt;libcxx;libcxxabi;libunwind" \
  -DLIBCXX_ENABLE_SHARED=ON \
  -DLIBCXX_ENABLE_STATIC=ON \
  -DLIBCXXABI_ENABLE_SHARED=ON \
  -DLIBCXXABI_ENABLE_STATIC=ON \
  -DLIBCXXABI_USE_LLVM_UNWINDER=OFF \
  -DLLVM_TARGETS_TO_BUILD="X86" \
  -DLLVM_ENABLE_ASSERTIONS=OFF \
  -DLLVM_OPTIMIZED_TABLEGEN=ON \
  -DPython3_EXECUTABLE=/usr/bin/python3 \
  /home/muyiwa/toolchain-build/llvm-project/llvm
```

### Enabled Components
- **Projects:** clang, clang-tools-extra (clang-tidy, clang-format), lld, mlir, openmp
- **Runtimes:** compiler-rt, libcxx, libcxxabi, libunwind
- **Targets:** X86
- **Bootstrap Compiler:** GCC 13 (system compiler)

## Build Monitoring

### Check Build Status
```bash
# Check if build is running
ps aux | grep ninja | grep llvm

# Monitor build progress
tail -f /home/muyiwa/toolchain-build/llvm-full-build/build.log

# Check build errors
grep -i "error" /home/muyiwa/toolchain-build/llvm-full-build/build.log | tail -20

# Build progress (approximate)
wc -l /home/muyiwa/toolchain-build/llvm-full-build/build.log
```

### Installation After Build
```bash
cd /home/muyiwa/toolchain-build/llvm-full-build
sudo /usr/local/bin/ninja install

# Verify installation
/opt/clang-21/bin/clang++ --version
/opt/clang-21/bin/clang-tidy --version
/opt/clang-21/bin/clang-format --version
ls -la /opt/clang-21/lib/clang/21/include/
ls -la /opt/clang-21/include/c++/v1/
ls -la /opt/clang-21/lib/libc++*
```

## Current Temporary Workaround

### Clang 21 Resource Directory
Copied builtin headers from previous build:
```bash
sudo cp -r /home/muyiwa/toolchain-build/llvm-build/lib/clang /opt/clang-21/lib/
```

### Using libstdc++ Temporarily
Current benchmark builds use GCC's libstdc++ until libc++ is fully built and installed.

## Post-Installation TODO

1. ‚úÖ Configure CMake - DONE
2. üîÑ Build LLVM/Clang (running in background)
3. ‚è≥ Install to /opt/clang-21 (sudo ninja install)
4. ‚è≥ Update FastestJSONInTheWest CMakeLists.txt to use libc++
5. ‚è≥ Rebuild benchmarks with full Clang 21 + libc++
6. ‚è≥ Run benchmarks and collect results
7. ‚è≥ Commit and push to GitHub

## Estimated Build Time
- Full LLVM build: **60-90 minutes** (depending on CPU cores)
- With 16 cores: ~45-60 minutes

## Notes
- Source: `/home/muyiwa/toolchain-build/llvm-project` (version 21.1.5)
- Previous incomplete build: `/home/muyiwa/toolchain-build/llvm-build`
- This build includes ALL requested features including clang-tidy, clang-format, MLIR, OpenMP
- libunwind disabled due to incompatibility with system unwinder
