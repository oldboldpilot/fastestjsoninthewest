# Configuration files
set(FASTJSON_CMAKE_DIR ${CMAKE_CURRENT_LIST_DIR})

# Include helper functions
include("${FASTJSON_CMAKE_DIR}/FeatureDetection.cmake")

# Find dependencies
include(CMakeFindDependencyMacro)

# Core dependencies
find_dependency(Threads REQUIRED)

# Optional dependencies based on configuration
@PACKAGE_INIT@

# Check if components are available
set(FASTJSON_COMPONENTS_AVAILABLE Core)

if(@FASTJSON_ENABLE_SIMD@)
    list(APPEND FASTJSON_COMPONENTS_AVAILABLE SIMD)
endif()

if(@FASTJSON_ENABLE_GPU@)
    list(APPEND FASTJSON_COMPONENTS_AVAILABLE GPU)
endif()

if(@FASTJSON_ENABLE_OPENMP@)
    find_dependency(OpenMP)
    list(APPEND FASTJSON_COMPONENTS_AVAILABLE OpenMP)
endif()

if(@FASTJSON_ENABLE_SIMULATOR@)
    list(APPEND FASTJSON_COMPONENTS_AVAILABLE Simulator)
endif()

# Include targets
include("${CMAKE_CURRENT_LIST_DIR}/FastestJSONTargets.cmake")

# Component validation
foreach(component ${FastestJSON_FIND_COMPONENTS})
    if(NOT component IN_LIST FASTJSON_COMPONENTS_AVAILABLE)
        set(FastestJSON_FOUND FALSE)
        set(FastestJSON_NOT_FOUND_MESSAGE "Component ${component} not available")
        break()
    endif()
endforeach()

# Set found flag
if(TARGET FastestJSON::fastjson)
    set(FastestJSON_FOUND TRUE)
endif()